# 运动控制卡使用指南


---

## 串口指令集
- **串口波特率**：115200
- **数据格式**：所有指令均为十六进制字节  
- **包头**：0xFF  
- **包尾**：0xFE  

### 数据包结构

**FF | 模式选择位 | 参数1 | 参数2 | ... | FE**

- **FF**：包头
- **模式选择位**: 选择控制模式
- **FE**：包尾  
- 中间字段根据模式不同而变化  

---

## 1. 电机控制模式（01）

| 字节位置 | 含义         | 可选值                          |
|---------|--------------|---------------------------------|
| 1       | 模式选择位   | 0x01                          |
| 2       | 电机编号     | 0x01 <br>0x02 <br>0x03  |
| 3       | 运动方式     | 0x01 定速<br>0x02 定步<br>0x03 停止 |
| 4       | 方向         | 0x01 正转<br>0x00 反转      |
| 5       | 数据高八位   | 00–FF (视运动方式而定,定速模式下为输入速度)          |
| 6       | 数据低八位   | 00–FF (视运动方式而定,定步模式下为输入步数)          |

#### 示例

- **定步前进 2000 步**  
  
```hex
  FF   01    01    02     01    07    D0   FE
     └─┬─┘ └─┬─┘ └─┬─┘  └─┬─┘ └─┬─┘ └─┬─┘
     模式 电机号 运动方式 方向 高,低八位数据（十六位被拆成高低8位数据发送）
```

## 2. 控制四路输出模式（`02`）

### 指令格式

```hex
  FF   02    0A   FE
     └─┬─┘ └─┬─┘
      模式 输出位
```
**输出位含义**
- **示例**
- 将字节 0x0A 转为 4 位二进制：1010

- bit3 → bit0 对应第 1 至 4 路输出：

| 路数   | 第1路 | 第2路 | 第3路 | 第4路 |
| ---- | :-: | :-: | :-: | :-: |
| 二进制位 |  1  |  0  |  1  |  0  |
| 电平   | 低电平 | 高电平 | 低电平 | 高电平 |

## 3. 读取八路输入

### 定时返回数据

间隔时间可调,支持最短间隔时间为1ms

### 返回示例

- **返回值**：`0xAA`（十六进制）  
- **二进制**：`10101010`  
- **含义**：从 **bit7 → bit0** 对应第 1–8 路输入，`1` = 高电平，`0` = 低电平  

| 输入路数 | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 |
|----------|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
| 状态     | 1 | 0 | 1 | 0 | 1 | 0 | 1 | 0 |



### 提示：

**二次开发时,若无特殊需求,仅修改电机引脚,或输入输出引脚,在配置完cubemx后只需要修改include.c里面的数组内容就能实现代码移植**
